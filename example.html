<html>
<head>
	<title>jsdb example</title>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.js"></script>
	<script type="text/javascript" src="/jsdb/jsdb.js"></script>
	<script type="text/javascript">
		/**
		*  NOTE: jsdb object is initialized when the script is included
		*/
		$(document).ready(function(){
			if(console){
				var msg = $('#message').html("See how cool all of that stuff below is?");
			}
			
			if(jsdb.supported())
			{
				//initialize our test data
				var array 	= ['one', 'two', 'three'];
				var object 	= {a:"foo", b:{c:"bar",d:"baz"}};
				var str 	= "hello world!";
				
				//output original values
				console.log(" -- Original Data:");
				console.log(array);
				console.log(object);
				console.log(str);
		
				/**
				*	jsdb.set() method
				*/
				jsdb.set("array", array);
				jsdb.set("object", object);
				jsdb.set("string", str);
				
				// examine stored values
				console.log(" -- Data Representations in Storage");
				console.log("Array %s",  jsdb.raw_value("array"));
				console.log("Object %s", jsdb.raw_value("object"));
				console.log("String %s", jsdb.raw_value("string"));
		
				/**
				*	jsdb.get() method
				*/
				var array_out 	= jsdb.get("array");
				var object_out 	= jsdb.get("object");
				var string_out	= jsdb.get("string");
				
				// examine retreived data
				console.log(" -- Retreived Data");
				console.log(array);
				console.log(object);
				console.log(str);
		
				/**
				*	jsdb.remove_item() method
				*/
				jsdb.remove_item("array", 2);
				jsdb.remove_item("object", "a");
				
				// examine updated object/array
				console.log(" -- Removed an array item and an object attribute");
				console.log(jsdb.get('array'));
				console.log(jsdb.get("object"));
			}
			
			jsdb.force_engine('cookies');

			/**
			*	Used as a caching mechanism for ajax content
			*/
			var selector = "#test_item";
			if( jsdb.get( selector )) {
				$( selector ).html("<strong>Cached:</strong>" +jsdb.get( selector ));
			} else {
				$.ajax({
					url:'/jsdb/ajax.html',
					success:function( response ) {
						$( selector ).html( response );
						jsdb.set( selector, response, true );
					}
				});
			}
			
			jsdb.set('cookie_object', {id:'abcs2323jalrk34jra',referrer:'local.testsite.com'});
			console.log(jsdb.get('cookie_object'));
			
			var saved_object = jsdb.get('object', function(data){
				data.b.c = "This has been altered";
				return data;
			});
			jsdb.get('asdfasdfasdf');
			console.log(saved_object);
		});
	</script>
</head>
<body>
	<div id="message">
		Check the browser's console to see what's happening.
	</div>
	<div id="test_item">
		This should load some ajax content, or pull it from cache
	</div>
</body>
</html>